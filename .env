VITE_API_URL=http://127.0.0.1:8000/api

**2. Update `services/api.ts` in your frontend**
Replace the mock implementation with real axios calls.

```typescript
import axios from 'axios';

const API_URL = import.meta.env.VITE_API_URL || 'http://127.0.0.1:8000/api';

// Create axios instance with interceptor for JWT
const client = axios.create({ baseURL: API_URL });

client.interceptors.request.use((config) => {
    const token = localStorage.getItem('auth_token'); // Ensure you store this on login
    if (token) config.headers.Authorization = `Bearer ${token}`;
    return config;
});

export const api = {
  auth: {
    login: async (email, password) => {
      const res = await client.post('/auth/login/', { email, password });
      // Save token
      localStorage.setItem('auth_token', res.data.access);
      return res.data; // Returns { access, refresh, id, name, role... }
    }
  },
  patients: {
    search: async (query) => {
      const res = await client.get(`/patients/?search=${query}`);
      return res.data;
    },
    getById: async (id) => (await client.get(`/patients/${id}/`)).data,
    create: async (data) => (await client.post('/patients/', data)).data,
  },
  visits: {
    create: async (data) => {
        // 1. Create Visit Record
        const visitRes = await client.post('/visits/', data);
        const visitId = visitRes.data.id;

        // 2. If attachment exists (Frontend needs to pass file object in data)
        if (data.attachmentFile) {
            const formData = new FormData();
            formData.append('file', data.attachmentFile);
            await client.post(`/visits/${visitId}/upload_attachment/`, formData, {
                headers: { 'Content-Type': 'multipart/form-data' }
            });
        }
        return visitRes.data;
    },
    getByPatientId: async (pid) => (await client.get(`/visits/?patientId=${pid}`)).data
  },
  dashboard: {
      // Create a specific dashboard endpoint in backend or calculate from patients count
      getStats: async () => [
          { name: 'Total Patients', value: '100+', changeType: 'neutral' }
      ]
  }
};

---

### **4. "From Scratch" Execution Instructions**

If you open VS Code today, here is the exact order of operations to get everything running.

**Terminal 1: Backend Setup**
```bash
cd backend
# 1. Initialize Database
python manage.py makemigrations users patients visits
python manage.py migrate

# 2. Create Superuser (Admin)
# Run this and follow prompts. Email: admin@hospital.com
python manage.py createsuperuser 

# 3. Start Server
python manage.py runserver

**Terminal 2: Frontend Setup**
```bash
# Return to root
cd .. 
# Install packages
npm install
# Run frontend
npm run dev

**Testing the Loop:**
1.  Go to `http://localhost:5173`.
2.  Login with the superuser credentials you created.
3.  Go to "Register Patient". Create a patient.
4.  Go to Patient Details. Click "Add Visit".
5.  Fill details + Attach a PDF. Click Save.
6.  The visit will save, then the file will upload.
7.  Click "Download History PDF" to test the report generation.